{"ast":null,"code":"var _jsxFileName = \"E:\\\\continous-authentication\\\\frontend\\\\src\\\\ContinuousAuth.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef, useCallback } from \"react\";\nimport * as faceapi from \"face-api.js\";\nimport Webcam from \"react-webcam\";\nimport forbiddenWordsList from \"./forbiddenWords.json\";\nimport \"./ContinuousAuth.css\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ContinuousAuth = () => {\n  _s();\n  const webcamRef = useRef(null);\n  const [faceDetected, setFaceDetected] = useState(false);\n  const [currentImage, setCurrentImage] = useState(null);\n  const [permissionsGranted, setPermissionsGranted] = useState(false);\n  const [examTerminated, setExamTerminated] = useState(false);\n  const [mediaStream, setMediaStream] = useState(null);\n  const [showPermissionMessage, setShowPermissionMessage] = useState(true);\n  const [noFaceDuration, setNoFaceDuration] = useState(0);\n  const [transcript, setTranscript] = useState(\"\");\n  const [violations, setViolations] = useState(0);\n  const forbiddenWords = forbiddenWordsList.words;\n  const [forbiddenCount, setForbiddenCount] = useState(0);\n  const detectedForbiddenWords = useRef(new Set());\n  const [violationCount, setViolationCount] = useState(0);\n  const [capturedImages, setCapturedImages] = useState([]);\n  const [referenceDescriptor, setReferenceDescriptor] = useState(null); // ← سيتم تخزين بصمة الوجه الأولى هنا\n\n  const recognitionRef = useRef(null);\n\n  // Custom Alert with Arabic and English\n  const customAlert = (messageAr, messageEn) => {\n    alert(`${messageAr}\\n${messageEn}`);\n  };\n\n  // Load required models\n  useEffect(() => {\n    const loadModels = async () => {\n      try {\n        await faceapi.nets.tinyFaceDetector.loadFromUri(\"/models\");\n        await faceapi.nets.faceLandmark68Net.loadFromUri(\"/models\");\n        await faceapi.nets.faceRecognitionNet.loadFromUri(\"/models\");\n        console.log(\"All required models loaded successfully\");\n      } catch (error) {\n        customAlert(\"فشل في تحميل نماذج التعرف على الوجه. يرجى التأكد من وجود ملفات النموذج في المسار الصحيح.\", \"Failed to load face recognition models. Please check the model files are in the correct path.\");\n      }\n    };\n    loadModels();\n  }, []);\n  const getPermissions = async () => {\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({\n        video: true,\n        audio: true\n      });\n      setMediaStream(stream);\n      setPermissionsGranted(true);\n      setShowPermissionMessage(false);\n    } catch (error) {\n      customAlert(\"يرجى السماح بالوصول إلى الكاميرا والميكروفون.\", \"Please allow access to camera and microphone.\");\n    }\n  };\n  const detectFace = async () => {\n    if (!webcamRef.current || !webcamRef.current.video) return;\n    const video = webcamRef.current.video;\n    const detections = await faceapi.detectAllFaces(video, new faceapi.TinyFaceDetectorOptions());\n    const isFacePresent = detections.length > 0;\n    setFaceDetected(isFacePresent);\n    if (!isFacePresent) {\n      setNoFaceDuration(prev => prev + 1);\n    } else {\n      setNoFaceDuration(0);\n\n      // إذا لم يكن هناك referenceDescriptor بعد، خذه من أول صورة\n      if (!referenceDescriptor) {\n        const imageSrc = webcamRef.current.getScreenshot();\n        const img = await faceapi.fetchImage(imageSrc);\n        const detection = await faceapi.detectSingleFace(img).withFaceLandmarks().withFaceDescriptor();\n        if (detection) {\n          setReferenceDescriptor(detection.descriptor);\n          console.log(\"✅ تم تخزين بصمة الوجه الأولى (enrollment)\");\n        }\n      } else {\n        // هنا نبدأ المقارنة مع أول صورة فقط\n        const imageSrc = webcamRef.current.getScreenshot();\n        const img = await faceapi.fetchImage(imageSrc);\n        const detection = await faceapi.detectSingleFace(img).withFaceLandmarks().withFaceDescriptor();\n        if (detection) {\n          const distance = faceapi.euclideanDistance(detection.descriptor, referenceDescriptor);\n          console.log(\"📏 مسافة التشابه:\", distance.toFixed(2));\n          if (distance > 0.5) {\n            const violationData = {\n              studentId: \"student_123\",\n              examId: \"exam_456\",\n              image: imageSrc,\n              timestamp: new Date().toISOString()\n            };\n            customAlert(\"⚠️ تم اكتشاف وجه مختلف!\", \"⚠️ Different face detected!\");\n            setViolationCount(prev => prev + 1);\n            setCapturedImages(prev => [...prev, violationData]);\n            try {\n              await axios.post(\"http://localhost:5000/api/violation\", violationData);\n            } catch (err) {\n              console.error(\"❌ خطأ في إرسال الانتهاك للخادم\", err);\n            }\n            if (violationCount + 1 >= 3) {\n              terminateExam();\n            }\n          }\n        }\n      }\n    }\n  };\n  useEffect(() => {\n    if (permissionsGranted && !examTerminated) {\n      const interval = setInterval(detectFace, 1000); // ← يتم التشغيل كل ثانية\n      return () => clearInterval(interval);\n    }\n  }, [permissionsGranted, examTerminated]);\n  useEffect(() => {\n    if (noFaceDuration >= 30) {\n      customAlert(\"⚠ لم يتم اكتشاف الوجه لمدة 30 ثانية.\", \"⚠ Face not detected for 30 seconds.\");\n    }\n  }, [noFaceDuration]);\n  const terminateExam = () => {\n    setExamTerminated(true);\n    customAlert(\"✖ تم إنهاء الامتحان بسبب انتهاكات متعددة!\", \"✖ Exam has been terminated due to multiple violations!\");\n    window.close();\n  };\n  const initializeSpeechRecognition = () => {\n    if (!(\"webkitSpeechRecognition\" in window)) {\n      console.warn(\"Web Speech API غير مدعوم في هذا المتصفح\");\n      return;\n    }\n    const recognition = new window.webkitSpeechRecognition();\n    recognition.continuous = true;\n    recognition.interimResults = true;\n    recognition.lang = \"ar-EG\";\n    recognition.onresult = event => {\n      let transcript = \"\";\n      for (let i = event.resultIndex; i < event.results.length; ++i) {\n        if (event.results[i].isFinal) {\n          transcript += event.results[i][0].transcript;\n        }\n      }\n      console.log(\"تم التعرف على النص:\", transcript);\n      setTranscript(transcript);\n      checkForbiddenWords(transcript);\n    };\n    recognition.onerror = event => {\n      console.error(\"خطأ في التعرف على الكلام\", event.error);\n    };\n    recognition.start();\n    recognitionRef.current = recognition;\n  };\n  const checkForbiddenWords = text => {\n    forbiddenWords.forEach(word => {\n      if (text.includes(word)) {\n        if (!detectedForbiddenWords.current.has(word)) {\n          detectedForbiddenWords.current.add(word);\n          const newCount = detectedForbiddenWords.current.size;\n          setForbiddenCount(newCount);\n          console.log(`تم اكتشاف كلمة محظورة جديدة: ${word} (المجموع: ${newCount})`);\n          if (newCount >= 3) {\n            customAlert(\"⚠️ تم اكتشاف 3 كلمات محظورة مختلفة! سيتم إنهاء الامتحان.\", \"⚠️ Detected 3 different forbidden words! Exam will be terminated.\");\n            terminateExam();\n          }\n        }\n      }\n    });\n  };\n  const detectSound = useCallback(() => {\n    if (!mediaStream) return;\n    const audioContext = new AudioContext();\n    const analyser = audioContext.createAnalyser();\n    const source = audioContext.createMediaStreamSource(mediaStream);\n    source.connect(analyser);\n    analyser.fftSize = 256;\n    const bufferLength = analyser.frequencyBinCount;\n    const dataArray = new Uint8Array(bufferLength);\n    const checkSound = () => {\n      analyser.getByteFrequencyData(dataArray);\n      const volume = dataArray.reduce((sum, value) => sum + value, 0) / bufferLength;\n      setSoundDetected(volume > 10);\n    };\n    const soundInterval = setInterval(checkSound, 1000);\n    return () => clearInterval(soundInterval);\n  }, [mediaStream]);\n  useEffect(() => {\n    if (permissionsGranted && !examTerminated) {\n      initializeSpeechRecognition();\n      detectSound();\n    }\n  }, [permissionsGranted, examTerminated]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"continuous-auth-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"\\u0646\\u0638\\u0627\\u0645 \\u0627\\u0644\\u0625\\u0634\\u0631\\u0627\\u0641 \\u0639\\u0644\\u0649 \\u0627\\u0644\\u0627\\u0645\\u062A\\u062D\\u0627\\u0646\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 7\n    }, this), showPermissionMessage && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"permission-message\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"\\u0625\\u0639\\u062F\\u0627\\u062F \\u0627\\u0644\\u0625\\u0634\\u0631\\u0627\\u0641 \\u0639\\u0644\\u0649 \\u0627\\u0644\\u0627\\u0645\\u062A\\u062D\\u0627\\u0646\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\u064A\\u062A\\u0637\\u0644\\u0628 \\u0647\\u0630\\u0627 \\u0627\\u0644\\u0627\\u0645\\u062A\\u062D\\u0627\\u0646 \\u0627\\u0644\\u0648\\u0635\\u0648\\u0644 \\u0625\\u0644\\u0649 \\u0627\\u0644\\u0643\\u0627\\u0645\\u064A\\u0631\\u0627 \\u0648\\u0627\\u0644\\u0645\\u064A\\u0643\\u0631\\u0648\\u0641\\u0648\\u0646 \\u0644\\u0623\\u063A\\u0631\\u0627\\u0636 \\u0627\\u0644\\u0625\\u0634\\u0631\\u0627\\u0641.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"permission-requirements\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"\\u2713 \\u064A\\u062C\\u0628 \\u062A\\u0645\\u0643\\u064A\\u0646 \\u0643\\u0634\\u0641 \\u0627\\u0644\\u0648\\u062C\\u0647\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 239,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"\\u2713 \\u064A\\u062C\\u0628 \\u062A\\u0641\\u0639\\u064A\\u0644 \\u0627\\u0644\\u0645\\u064A\\u0643\\u0631\\u0648\\u0641\\u0648\\u0646\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"permission-button\",\n        onClick: getPermissions,\n        children: \"\\u062A\\u0645\\u0643\\u064A\\u0646 \\u0627\\u0644\\u0643\\u0627\\u0645\\u064A\\u0631\\u0627 \\u0648\\u0627\\u0644\\u0645\\u064A\\u0643\\u0631\\u0648\\u0641\\u0648\\u0646\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 9\n    }, this), permissionsGranted && !examTerminated && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"monitoring-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"video-section\",\n        children: [/*#__PURE__*/_jsxDEV(Webcam, {\n          audio: true,\n          ref: webcamRef,\n          screenshotFormat: \"image/jpeg\",\n          className: \"webcam\",\n          videoConstraints: {\n            facingMode: \"user\",\n            width: 480,\n            height: 360\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"status-indicators\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: `status-indicator ${faceDetected ? \"active\" : \"\"}`,\n            children: /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \".Face Detection\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 265,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 264,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"violation-counter\",\n            children: [\"\\u0639\\u062F\\u062F \\u0627\\u0644\\u0627\\u0646\\u062A\\u0647\\u0627\\u0643\\u0627\\u062A: \", violationCount, \"/3\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 267,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 251,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"audio-section\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          children: \"\\u0627\\u0644\\u0643\\u0644\\u0645\\u0627\\u062A \\u0627\\u0644\\u0645\\u062D\\u0638\\u0648\\u0631\\u0629\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 272,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"violation-counter\",\n          children: [\"\\u0639\\u062F\\u062F \\u0627\\u0644\\u0643\\u0644\\u0645\\u0627\\u062A \\u0627\\u0644\\u0645\\u062D\\u0638\\u0648\\u0631\\u0629: \", forbiddenCount, \"/3\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 273,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"transcript-content\",\n          dir: \"rtl\",\n          children: transcript || \"في انتظار إدخال الصوت...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 274,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 271,\n        columnNumber: 11\n      }, this), capturedImages.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"all-captured-images\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          children: \"\\u062C\\u0645\\u064A\\u0639 \\u0627\\u0644\\u0635\\u0648\\u0631 \\u0627\\u0644\\u062A\\u064A \\u062A\\u062D\\u062A\\u0648\\u064A \\u0639\\u0644\\u0649 \\u0627\\u0646\\u062A\\u0647\\u0627\\u0643\\u0627\\u062A\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 279,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"captured-images-grid\",\n          children: capturedImages.map((imgObj, index) => /*#__PURE__*/_jsxDEV(\"img\", {\n            src: imgObj.image,\n            alt: `Violation ${index}`,\n            className: \"captured-image-small\"\n          }, index, false, {\n            fileName: _jsxFileName,\n            lineNumber: 282,\n            columnNumber: 19\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 280,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 278,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 9\n    }, this), examTerminated && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"termination-message\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"\\u2716 \\u062A\\u0645 \\u0625\\u0646\\u0647\\u0627\\u0621 \\u0627\\u0644\\u0627\\u0645\\u062A\\u062D\\u0627\\u0646\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 297,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\u0628\\u0633\\u0628\\u0628 \\u0627\\u0643\\u062A\\u0634\\u0627\\u0641 \\u0627\\u0646\\u062A\\u0647\\u0627\\u0643\\u0627\\u062A \\u0645\\u062A\\u0639\\u062F\\u062F\\u0629. \\u064A\\u0631\\u062C\\u0649 \\u0627\\u0644\\u062A\\u0648\\u0627\\u0635\\u0644 \\u0645\\u0639 \\u0627\\u0644\\u0645\\u064F\\u062F\\u0631\\u0650\\u0651\\u0633.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 298,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 231,\n    columnNumber: 5\n  }, this);\n};\n_s(ContinuousAuth, \"JGhFiX1GDCX7Cwy5Tf5y9jzCyVA=\");\n_c = ContinuousAuth;\nexport default ContinuousAuth;\nvar _c;\n$RefreshReg$(_c, \"ContinuousAuth\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","faceapi","Webcam","forbiddenWordsList","axios","jsxDEV","_jsxDEV","ContinuousAuth","_s","webcamRef","faceDetected","setFaceDetected","currentImage","setCurrentImage","permissionsGranted","setPermissionsGranted","examTerminated","setExamTerminated","mediaStream","setMediaStream","showPermissionMessage","setShowPermissionMessage","noFaceDuration","setNoFaceDuration","transcript","setTranscript","violations","setViolations","forbiddenWords","words","forbiddenCount","setForbiddenCount","detectedForbiddenWords","Set","violationCount","setViolationCount","capturedImages","setCapturedImages","referenceDescriptor","setReferenceDescriptor","recognitionRef","customAlert","messageAr","messageEn","alert","loadModels","nets","tinyFaceDetector","loadFromUri","faceLandmark68Net","faceRecognitionNet","console","log","error","getPermissions","stream","navigator","mediaDevices","getUserMedia","video","audio","detectFace","current","detections","detectAllFaces","TinyFaceDetectorOptions","isFacePresent","length","prev","imageSrc","getScreenshot","img","fetchImage","detection","detectSingleFace","withFaceLandmarks","withFaceDescriptor","descriptor","distance","euclideanDistance","toFixed","violationData","studentId","examId","image","timestamp","Date","toISOString","post","err","terminateExam","interval","setInterval","clearInterval","window","close","initializeSpeechRecognition","warn","recognition","webkitSpeechRecognition","continuous","interimResults","lang","onresult","event","i","resultIndex","results","isFinal","checkForbiddenWords","onerror","start","text","forEach","word","includes","has","add","newCount","size","detectSound","audioContext","AudioContext","analyser","createAnalyser","source","createMediaStreamSource","connect","fftSize","bufferLength","frequencyBinCount","dataArray","Uint8Array","checkSound","getByteFrequencyData","volume","reduce","sum","value","setSoundDetected","soundInterval","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","ref","screenshotFormat","videoConstraints","facingMode","width","height","dir","map","imgObj","index","src","alt","_c","$RefreshReg$"],"sources":["E:/continous-authentication/frontend/src/ContinuousAuth.js"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback } from \"react\";\r\nimport * as faceapi from \"face-api.js\";\r\nimport Webcam from \"react-webcam\";\r\nimport forbiddenWordsList from \"./forbiddenWords.json\";\r\nimport \"./ContinuousAuth.css\";\r\nimport axios from \"axios\";\r\n\r\nconst ContinuousAuth = () => {\r\n  const webcamRef = useRef(null);\r\n  const [faceDetected, setFaceDetected] = useState(false);\r\n  const [currentImage, setCurrentImage] = useState(null);\r\n  const [permissionsGranted, setPermissionsGranted] = useState(false);\r\n  const [examTerminated, setExamTerminated] = useState(false);\r\n  const [mediaStream, setMediaStream] = useState(null);\r\n  const [showPermissionMessage, setShowPermissionMessage] = useState(true);\r\n  const [noFaceDuration, setNoFaceDuration] = useState(0);\r\n  const [transcript, setTranscript] = useState(\"\");\r\n  const [violations, setViolations] = useState(0);\r\n  const forbiddenWords = forbiddenWordsList.words;\r\n  const [forbiddenCount, setForbiddenCount] = useState(0);\r\n  const detectedForbiddenWords = useRef(new Set());\r\n  const [violationCount, setViolationCount] = useState(0);\r\n  const [capturedImages, setCapturedImages] = useState([]);\r\n  const [referenceDescriptor, setReferenceDescriptor] = useState(null); // ← سيتم تخزين بصمة الوجه الأولى هنا\r\n\r\n  const recognitionRef = useRef(null);\r\n\r\n  // Custom Alert with Arabic and English\r\n  const customAlert = (messageAr, messageEn) => {\r\n    alert(`${messageAr}\\n${messageEn}`);\r\n  };\r\n\r\n  // Load required models\r\n  useEffect(() => {\r\n    const loadModels = async () => {\r\n      try {\r\n        await faceapi.nets.tinyFaceDetector.loadFromUri(\"/models\");\r\n        await faceapi.nets.faceLandmark68Net.loadFromUri(\"/models\");\r\n        await faceapi.nets.faceRecognitionNet.loadFromUri(\"/models\");\r\n        console.log(\"All required models loaded successfully\");\r\n      } catch (error) {\r\n        customAlert(\r\n          \"فشل في تحميل نماذج التعرف على الوجه. يرجى التأكد من وجود ملفات النموذج في المسار الصحيح.\",\r\n          \"Failed to load face recognition models. Please check the model files are in the correct path.\"\r\n        );\r\n      }\r\n    };\r\n    loadModels();\r\n  }, []);\r\n\r\n  const getPermissions = async () => {\r\n    try {\r\n      const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });\r\n      setMediaStream(stream);\r\n      setPermissionsGranted(true);\r\n      setShowPermissionMessage(false);\r\n    } catch (error) {\r\n      customAlert(\r\n        \"يرجى السماح بالوصول إلى الكاميرا والميكروفون.\",\r\n        \"Please allow access to camera and microphone.\"\r\n      );\r\n    }\r\n  };\r\n\r\n  const detectFace = async () => {\r\n    if (!webcamRef.current || !webcamRef.current.video) return;\r\n\r\n    const video = webcamRef.current.video;\r\n    const detections = await faceapi.detectAllFaces(video, new faceapi.TinyFaceDetectorOptions());\r\n    const isFacePresent = detections.length > 0;\r\n    setFaceDetected(isFacePresent);\r\n\r\n    if (!isFacePresent) {\r\n      setNoFaceDuration((prev) => prev + 1);\r\n    } else {\r\n      setNoFaceDuration(0);\r\n\r\n      // إذا لم يكن هناك referenceDescriptor بعد، خذه من أول صورة\r\n      if (!referenceDescriptor) {\r\n        const imageSrc = webcamRef.current.getScreenshot();\r\n        const img = await faceapi.fetchImage(imageSrc);\r\n        const detection = await faceapi\r\n          .detectSingleFace(img)\r\n          .withFaceLandmarks()\r\n          .withFaceDescriptor();\r\n\r\n        if (detection) {\r\n          setReferenceDescriptor(detection.descriptor);\r\n          console.log(\"✅ تم تخزين بصمة الوجه الأولى (enrollment)\");\r\n        }\r\n      } else {\r\n        // هنا نبدأ المقارنة مع أول صورة فقط\r\n        const imageSrc = webcamRef.current.getScreenshot();\r\n        const img = await faceapi.fetchImage(imageSrc);\r\n        const detection = await faceapi\r\n          .detectSingleFace(img)\r\n          .withFaceLandmarks()\r\n          .withFaceDescriptor();\r\n\r\n        if (detection) {\r\n          const distance = faceapi.euclideanDistance(detection.descriptor, referenceDescriptor);\r\n          console.log(\"📏 مسافة التشابه:\", distance.toFixed(2));\r\n\r\n          if (distance > 0.5) {\r\n            const violationData = {\r\n              studentId: \"student_123\",\r\n              examId: \"exam_456\",\r\n              image: imageSrc,\r\n              timestamp: new Date().toISOString(),\r\n            };\r\n\r\n            customAlert(\"⚠️ تم اكتشاف وجه مختلف!\", \"⚠️ Different face detected!\");\r\n            setViolationCount((prev) => prev + 1);\r\n            setCapturedImages((prev) => [...prev, violationData]);\r\n\r\n            try {\r\n              await axios.post(\"http://localhost:5000/api/violation\", violationData);\r\n            } catch (err) {\r\n              console.error(\"❌ خطأ في إرسال الانتهاك للخادم\", err);\r\n            }\r\n\r\n            if (violationCount + 1 >= 3) {\r\n              terminateExam();\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (permissionsGranted && !examTerminated) {\r\n      const interval = setInterval(detectFace, 1000); // ← يتم التشغيل كل ثانية\r\n      return () => clearInterval(interval);\r\n    }\r\n  }, [permissionsGranted, examTerminated]);\r\n\r\n  useEffect(() => {\r\n    if (noFaceDuration >= 30) {\r\n      customAlert(\r\n        \"⚠ لم يتم اكتشاف الوجه لمدة 30 ثانية.\",\r\n        \"⚠ Face not detected for 30 seconds.\"\r\n      );\r\n    }\r\n  }, [noFaceDuration]);\r\n\r\n  const terminateExam = () => {\r\n    setExamTerminated(true);\r\n    customAlert(\r\n      \"✖ تم إنهاء الامتحان بسبب انتهاكات متعددة!\",\r\n      \"✖ Exam has been terminated due to multiple violations!\"\r\n    );\r\n    window.close();\r\n  };\r\n\r\n  const initializeSpeechRecognition = () => {\r\n    if (!(\"webkitSpeechRecognition\" in window)) {\r\n      console.warn(\"Web Speech API غير مدعوم في هذا المتصفح\");\r\n      return;\r\n    }\r\n\r\n    const recognition = new window.webkitSpeechRecognition();\r\n    recognition.continuous = true;\r\n    recognition.interimResults = true;\r\n    recognition.lang = \"ar-EG\";\r\n    recognition.onresult = (event) => {\r\n      let transcript = \"\";\r\n      for (let i = event.resultIndex; i < event.results.length; ++i) {\r\n        if (event.results[i].isFinal) {\r\n          transcript += event.results[i][0].transcript;\r\n        }\r\n      }\r\n      console.log(\"تم التعرف على النص:\", transcript);\r\n      setTranscript(transcript);\r\n      checkForbiddenWords(transcript);\r\n    };\r\n    recognition.onerror = (event) => {\r\n      console.error(\"خطأ في التعرف على الكلام\", event.error);\r\n    };\r\n    recognition.start();\r\n    recognitionRef.current = recognition;\r\n  };\r\n\r\n  const checkForbiddenWords = (text) => {\r\n    forbiddenWords.forEach((word) => {\r\n      if (text.includes(word)) {\r\n        if (!detectedForbiddenWords.current.has(word)) {\r\n          detectedForbiddenWords.current.add(word);\r\n          const newCount = detectedForbiddenWords.current.size;\r\n          setForbiddenCount(newCount);\r\n\r\n          console.log(`تم اكتشاف كلمة محظورة جديدة: ${word} (المجموع: ${newCount})`);\r\n          if (newCount >= 3) {\r\n            customAlert(\r\n              \"⚠️ تم اكتشاف 3 كلمات محظورة مختلفة! سيتم إنهاء الامتحان.\",\r\n              \"⚠️ Detected 3 different forbidden words! Exam will be terminated.\"\r\n            );\r\n            terminateExam();\r\n          }\r\n        }\r\n      }\r\n    });\r\n  };\r\n\r\n  const detectSound = useCallback(() => {\r\n    if (!mediaStream) return;\r\n    const audioContext = new AudioContext();\r\n    const analyser = audioContext.createAnalyser();\r\n    const source = audioContext.createMediaStreamSource(mediaStream);\r\n    source.connect(analyser);\r\n    analyser.fftSize = 256;\r\n    const bufferLength = analyser.frequencyBinCount;\r\n    const dataArray = new Uint8Array(bufferLength);\r\n    const checkSound = () => {\r\n      analyser.getByteFrequencyData(dataArray);\r\n      const volume = dataArray.reduce((sum, value) => sum + value, 0) / bufferLength;\r\n      setSoundDetected(volume > 10);\r\n    };\r\n    const soundInterval = setInterval(checkSound, 1000);\r\n    return () => clearInterval(soundInterval);\r\n  }, [mediaStream]);\r\n\r\n  useEffect(() => {\r\n    if (permissionsGranted && !examTerminated) {\r\n      initializeSpeechRecognition();\r\n      detectSound();\r\n    }\r\n  }, [permissionsGranted, examTerminated]);\r\n\r\n  return (\r\n    <div className=\"continuous-auth-container\">\r\n      <h2>نظام الإشراف على الامتحان</h2>\r\n\r\n      {showPermissionMessage && (\r\n        <div className=\"permission-message\">\r\n          <h3>إعداد الإشراف على الامتحان</h3>\r\n          <p>يتطلب هذا الامتحان الوصول إلى الكاميرا والميكروفون لأغراض الإشراف.</p>\r\n          <div className=\"permission-requirements\">\r\n            <p>✓ يجب تمكين كشف الوجه</p>\r\n            <p>✓ يجب تفعيل الميكروفون</p>\r\n          </div>\r\n          <button className=\"permission-button\" onClick={getPermissions}>\r\n            تمكين الكاميرا والميكروفون\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {permissionsGranted && !examTerminated && (\r\n        <div className=\"monitoring-container\">\r\n          {/* Video Section */}\r\n          <div className=\"video-section\">\r\n            <Webcam\r\n              audio={true}\r\n              ref={webcamRef}\r\n              screenshotFormat=\"image/jpeg\"\r\n              className=\"webcam\"\r\n              videoConstraints={{\r\n                facingMode: \"user\",\r\n                width: 480,\r\n                height: 360,\r\n              }}\r\n            />\r\n            <div className=\"status-indicators\">\r\n              <div className={`status-indicator ${faceDetected ? \"active\" : \"\"}`}>\r\n                <span>.Face Detection</span>\r\n              </div>\r\n              <span className=\"violation-counter\">عدد الانتهاكات: {violationCount}/3</span>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"audio-section\">\r\n            <h4>الكلمات المحظورة</h4>\r\n            <span className=\"violation-counter\">عدد الكلمات المحظورة: {forbiddenCount}/3</span>\r\n            <div className=\"transcript-content\" dir=\"rtl\">{transcript || \"في انتظار إدخال الصوت...\"}</div>\r\n          </div>\r\n\r\n          {capturedImages.length > 0 && (\r\n            <div className=\"all-captured-images\">\r\n              <h4>جميع الصور التي تحتوي على انتهاكات</h4>\r\n              <div className=\"captured-images-grid\">\r\n                {capturedImages.map((imgObj, index) => (\r\n                  <img\r\n                    key={index}\r\n                    src={imgObj.image}\r\n                    alt={`Violation ${index}`}\r\n                    className=\"captured-image-small\"\r\n                  />\r\n                ))}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {examTerminated && (\r\n        <div className=\"termination-message\">\r\n          <h3>✖ تم إنهاء الامتحان</h3>\r\n          <p>بسبب اكتشاف انتهاكات متعددة. يرجى التواصل مع المُدرِّس.</p>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ContinuousAuth;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}