{"ast":null,"code":"var _jsxFileName = \"E:\\\\continous-authentication\\\\frontend\\\\src\\\\ContinuousAuth.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef, useCallback } from \"react\";\nimport * as faceapi from \"face-api.js\";\nimport Webcam from \"react-webcam\";\nimport forbiddenWordsList from \"./forbiddenWords.json\";\nimport \"./ContinuousAuth.css\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ContinuousAuth = () => {\n  _s();\n  const webcamRef = useRef(null);\n  const recognitionRef = useRef(null);\n  const [faceDetected, setFaceDetected] = useState(false);\n  const [soundDetected, setSoundDetected] = useState(false);\n  const [currentImage, setCurrentImage] = useState(null);\n  const [permissionsGranted, setPermissionsGranted] = useState(false);\n  const [examTerminated, setExamTerminated] = useState(false);\n  const [mediaStream, setMediaStream] = useState(null);\n  const [showPermissionMessage, setShowPermissionMessage] = useState(true);\n  const [noFaceDuration, setNoFaceDuration] = useState(0);\n  const [transcript, setTranscript] = useState(\"\");\n  const [violations, setViolations] = useState(0);\n  const forbiddenWords = forbiddenWordsList.words;\n  const [forbiddenCount, setForbiddenCount] = useState(0);\n  const detectedForbiddenWords = useRef(new Set());\n\n  // Face Comparison States\n  const [referenceDescriptor, setReferenceDescriptor] = useState(null);\n  const [violationCount, setViolationCount] = useState(0);\n  const [capturedImages, setCapturedImages] = useState([]);\n\n  // Custom Alert with Arabic and English\n  const customAlert = (messageAr, messageEn) => {\n    alert(`${messageAr}\\n\\n${messageEn}`);\n  };\n\n  // Load required models\n  useEffect(() => {\n    const loadModels = async () => {\n      try {\n        await faceapi.nets.tinyFaceDetector.loadFromUri(\"/models\");\n        await faceapi.nets.faceLandmark68Net.loadFromUri(\"/models\");\n        await faceapi.nets.faceRecognitionNet.loadFromUri(\"/models\");\n        console.log(\"All required models loaded successfully\");\n      } catch (error) {\n        customAlert(\"فشل في تحميل نماذج التعرف على الوجه. يرجى التأكد من وجود ملفات النموذج في المسار الصحيح.\", \"Failed to load face recognition models. Please check the model files are in the correct path.\");\n      }\n    };\n    loadModels();\n  }, []);\n  const getPermissions = async () => {\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({\n        video: true,\n        audio: true\n      });\n      setMediaStream(stream);\n      setPermissionsGranted(true);\n      setShowPermissionMessage(false);\n      initializeSpeechRecognition();\n    } catch (error) {\n      customAlert(\"يرجى السماح بالوصول إلى الكاميرا والميكروفون.\", \"Please allow access to camera and microphone.\");\n      setShowPermissionMessage(true);\n    }\n  };\n  const initializeSpeechRecognition = () => {\n    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;\n    if (!SpeechRecognition) {\n      console.error(\"API التعرف على الصوت غير مدعومة في هذا المتصفح\");\n      return;\n    }\n    recognitionRef.current = new SpeechRecognition();\n    recognitionRef.current.continuous = true;\n    recognitionRef.current.interimResults = false;\n    recognitionRef.current.lang = \"ar-SA\";\n    recognitionRef.current.onresult = event => {\n      const last = event.results.length - 1;\n      const text = event.results[last][0].transcript;\n      console.log(\"تم التعرف على النص:\", text);\n      setTranscript(text);\n      checkForbiddenWords(text);\n    };\n    recognitionRef.current.onerror = event => {\n      console.error(\"خطأ في التعرف على الكلام\", event.error);\n    };\n    recognitionRef.current.start();\n    recognitionRef.current.onend = () => {\n      recognitionRef.current.start();\n    };\n  };\n  const checkForbiddenWords = text => {\n    forbiddenWords.forEach(word => {\n      if (text.includes(word)) {\n        if (!detectedForbiddenWords.current.has(word)) {\n          detectedForbiddenWords.current.add(word);\n          const newCount = detectedForbiddenWords.current.size;\n          setForbiddenCount(newCount);\n          console.log(`تم اكتشاف كلمة محظورة جديدة: ${word} (المجموع: ${newCount})`);\n          if (newCount >= 3) {\n            customAlert(\"⚠️ تم اكتشاف 3 كلمات محظورة مختلفة! سيتم إنهاء الامتحان.\", \"⚠️ Detected 3 different forbidden words! Exam will be terminated.\");\n            terminateExam();\n          }\n        }\n      }\n    });\n  };\n  const terminateExam = () => {\n    setExamTerminated(true);\n    customAlert(\"✖ تم إنهاء الامتحان بسبب انتهاكات متعددة!\", \"✖ Exam has been terminated due to multiple violations!\");\n    window.close();\n  };\n  const detectFace = async () => {\n    if (webcamRef.current && webcamRef.current.video.readyState === 4) {\n      const video = webcamRef.current.video;\n      const detections = await faceapi.detectAllFaces(video, new faceapi.TinyFaceDetectorOptions());\n      const isFacePresent = detections.length > 0;\n      setFaceDetected(isFacePresent);\n      setNoFaceDuration(prev => isFacePresent ? 0 : prev + 1);\n    }\n  };\n  useEffect(() => {\n    if (permissionsGranted) {\n      const interval = setInterval(detectFace, 1000);\n      return () => clearInterval(interval);\n    }\n  }, [permissionsGranted]);\n  useEffect(() => {\n    if (noFaceDuration >= 30) {\n      customAlert(\"⚠ لم يتم اكتشاف الوجه لمدة 30 ثانية. يرجى التأكد من ظهور وجهك بوضوح.\", \"⚠ Face not detected for 30 seconds. Please make sure your face is clearly visible.\");\n      setNoFaceDuration(0);\n    }\n  }, [noFaceDuration]);\n  const detectSound = useCallback(() => {\n    if (!mediaStream) return;\n    const audioContext = new AudioContext();\n    const analyser = audioContext.createAnalyser();\n    const source = audioContext.createMediaStreamSource(mediaStream);\n    source.connect(analyser);\n    analyser.fftSize = 256;\n    const bufferLength = analyser.frequencyBinCount;\n    const dataArray = new Uint8Array(bufferLength);\n    const checkSound = () => {\n      analyser.getByteFrequencyData(dataArray);\n      const volume = dataArray.reduce((sum, value) => sum + value, 0) / bufferLength;\n      setSoundDetected(volume > 10);\n      requestAnimationFrame(checkSound);\n    };\n    checkSound();\n  }, [mediaStream]);\n  useEffect(() => {\n    if (permissionsGranted) {\n      detectSound();\n    }\n  }, [permissionsGranted, detectSound]);\n  const captureAndSendImage = async () => {\n    if (!webcamRef.current) return;\n    const imageSrc = webcamRef.current.getScreenshot();\n    setCurrentImage(imageSrc);\n    try {\n      const img = await faceapi.fetchImage(imageSrc);\n      const detection = await faceapi.detectSingleFace(img, new faceapi.TinyFaceDetectorOptions()).withFaceLandmarks().withFaceDescriptor();\n      if (!detection) return;\n      if (!referenceDescriptor) {\n        setReferenceDescriptor(detection.descriptor);\n        console.log(\"تم تخزين وجه المرجع\");\n        return;\n      }\n      const distance = faceapi.euclideanDistance(referenceDescriptor, detection.descriptor);\n      if (distance > 0.6) {\n        customAlert(\"⚠️ تم اكتشاف شخص مختلف!\", \"⚠️ Different person detected!\");\n        const violationData = {\n          studentId: \"student_123\",\n          examId: \"exam_456\",\n          image: imageSrc,\n          timestamp: new Date().toISOString()\n        };\n        try {\n          await axios.post(\"http://localhost:5000/api/violation\", violationData);\n          setViolationCount(prev => prev + 1);\n          setCapturedImages(prev => [...prev, violationData]);\n          if (violationCount + 1 >= 3) {\n            customAlert(\"✖ تم إنهاء الامتحان بسبب انتهاكات متعددة.\", \"✖ Exam terminated due to multiple violations.\");\n            terminateExam();\n          }\n        } catch (err) {\n          console.error(\"خطأ في إرسال الانتهاك للخادم\", err);\n        }\n      }\n    } catch (err) {\n      console.error(\"خطأ في تحليل الوجه\", err);\n    }\n  };\n  useEffect(() => {\n    if (permissionsGranted && !examTerminated) {\n      const interval = setInterval(captureAndSendImage, 60000);\n      return () => clearInterval(interval);\n    }\n  }, [permissionsGranted, examTerminated]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"continuous-auth-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"\\u0646\\u0638\\u0627\\u0645 \\u0627\\u0644\\u0625\\u0634\\u0631\\u0627\\u0641 \\u0639\\u0644\\u0649 \\u0627\\u0644\\u0627\\u0645\\u062A\\u062D\\u0627\\u0646\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 7\n    }, this), showPermissionMessage && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"permission-message\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"\\u0625\\u0639\\u062F\\u0627\\u062F \\u0627\\u0644\\u0625\\u0634\\u0631\\u0627\\u0641 \\u0639\\u0644\\u0649 \\u0627\\u0644\\u0627\\u0645\\u062A\\u062D\\u0627\\u0646\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\u064A\\u062A\\u0637\\u0644\\u0628 \\u0647\\u0630\\u0627 \\u0627\\u0644\\u0627\\u0645\\u062A\\u062D\\u0627\\u0646 \\u0627\\u0644\\u0648\\u0635\\u0648\\u0644 \\u0625\\u0644\\u0649 \\u0627\\u0644\\u0643\\u0627\\u0645\\u064A\\u0631\\u0627 \\u0648\\u0627\\u0644\\u0645\\u064A\\u0643\\u0631\\u0648\\u0641\\u0648\\u0646 \\u0644\\u0623\\u063A\\u0631\\u0627\\u0636 \\u0627\\u0644\\u0625\\u0634\\u0631\\u0627\\u0641.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"permission-requirements\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"\\u2713 \\u064A\\u062C\\u0628 \\u062A\\u0645\\u0643\\u064A\\u0646 \\u0643\\u0634\\u0641 \\u0627\\u0644\\u0648\\u062C\\u0647\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"\\u2713 \\u064A\\u062C\\u0628 \\u062A\\u0641\\u0639\\u064A\\u0644 \\u0627\\u0644\\u0645\\u064A\\u0643\\u0631\\u0648\\u0641\\u0648\\u0646\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 259,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"permission-button\",\n        onClick: getPermissions,\n        children: \"\\u062A\\u0645\\u0643\\u064A\\u0646 \\u0627\\u0644\\u0643\\u0627\\u0645\\u064A\\u0631\\u0627 \\u0648\\u0627\\u0644\\u0645\\u064A\\u0643\\u0631\\u0648\\u0641\\u0648\\u0646\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 261,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 9\n    }, this), permissionsGranted && !examTerminated && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"monitoring-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"video-section\",\n        children: [/*#__PURE__*/_jsxDEV(Webcam, {\n          audio: true,\n          ref: webcamRef,\n          screenshotFormat: \"image/jpeg\",\n          className: \"webcam\",\n          videoConstraints: {\n            facingMode: \"user\",\n            width: 480,\n            height: 360\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 271,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"status-indicators\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: `status-indicator ${faceDetected ? \"active\" : \"\"}`,\n            children: faceDetected ? \"تم اكتشاف الوجه\" : \"لا يوجد وجه\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 283,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `status-indicator ${soundDetected ? \"active\" : \"\"}`,\n            children: soundDetected ? \"تم اكتشاف صوت\" : \"لا يوجد صوت\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 286,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 282,\n          columnNumber: 13\n        }, this), currentImage && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"captured-image-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            children: \"\\u0622\\u062E\\u0631 \\u0635\\u0648\\u0631\\u0629 \\u0645\\u0644\\u062A\\u0642\\u0637\\u0629\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 292,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n            src: currentImage,\n            alt: \"Last captured face\",\n            className: \"captured-image\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 293,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 291,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"transcript-section\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"transcript-box\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"transcript-header\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"\\u0646\\u0635 \\u0627\\u0644\\u062E\\u0637\\u0627\\u0628 \\u0628\\u0627\\u0644\\u0639\\u0631\\u0628\\u064A\\u0629\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 302,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"violation-counter\",\n              children: [\"\\u0639\\u062F\\u062F \\u0627\\u0644\\u0643\\u0644\\u0645\\u0627\\u062A \\u0627\\u0644\\u0645\\u062D\\u0638\\u0648\\u0631\\u0629: \", forbiddenCount, \"/3\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 303,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 301,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"transcript-content\",\n            dir: \"rtl\",\n            children: transcript || \"في انتظار إدخال الصوت...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 305,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 300,\n          columnNumber: 13\n        }, this), capturedImages.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"all-captured-images\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            children: \"\\u062C\\u0645\\u064A\\u0639 \\u0627\\u0644\\u0635\\u0648\\u0631 \\u0627\\u0644\\u062A\\u064A \\u062A\\u062D\\u062A\\u0648\\u064A \\u0639\\u0644\\u0649 \\u0627\\u0646\\u062A\\u0647\\u0627\\u0643\\u0627\\u062A\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 312,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"captured-images-grid\",\n            children: capturedImages.map((imgObj, index) => /*#__PURE__*/_jsxDEV(\"img\", {\n              src: imgObj.image,\n              alt: `Violation ${index}`,\n              className: \"captured-image-small\"\n            }, index, false, {\n              fileName: _jsxFileName,\n              lineNumber: 315,\n              columnNumber: 21\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 313,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 311,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 299,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 268,\n      columnNumber: 9\n    }, this), examTerminated && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"termination-message\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"\\u2716 \\u062A\\u0645 \\u0625\\u0646\\u0647\\u0627\\u0621 \\u0627\\u0644\\u0627\\u0645\\u062A\\u062D\\u0627\\u0646\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 331,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\u0628\\u0633\\u0628\\u0628 \\u0627\\u0643\\u062A\\u0634\\u0627\\u0641 \\u0627\\u0646\\u062A\\u0647\\u0627\\u0643\\u0627\\u062A \\u0645\\u062A\\u0639\\u062F\\u062F\\u0629. \\u064A\\u0631\\u062C\\u0649 \\u0627\\u0644\\u062A\\u0648\\u0627\\u0635\\u0644 \\u0645\\u0639 \\u0627\\u0644\\u0645\\u064F\\u062F\\u0631\\u0650\\u0651\\u0633.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 332,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 330,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 250,\n    columnNumber: 5\n  }, this);\n};\n_s(ContinuousAuth, \"jhyhkn1Y1ei9E64sHKzIqxRTuRE=\");\n_c = ContinuousAuth;\nexport default ContinuousAuth;\nvar _c;\n$RefreshReg$(_c, \"ContinuousAuth\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","faceapi","Webcam","forbiddenWordsList","axios","jsxDEV","_jsxDEV","ContinuousAuth","_s","webcamRef","recognitionRef","faceDetected","setFaceDetected","soundDetected","setSoundDetected","currentImage","setCurrentImage","permissionsGranted","setPermissionsGranted","examTerminated","setExamTerminated","mediaStream","setMediaStream","showPermissionMessage","setShowPermissionMessage","noFaceDuration","setNoFaceDuration","transcript","setTranscript","violations","setViolations","forbiddenWords","words","forbiddenCount","setForbiddenCount","detectedForbiddenWords","Set","referenceDescriptor","setReferenceDescriptor","violationCount","setViolationCount","capturedImages","setCapturedImages","customAlert","messageAr","messageEn","alert","loadModels","nets","tinyFaceDetector","loadFromUri","faceLandmark68Net","faceRecognitionNet","console","log","error","getPermissions","stream","navigator","mediaDevices","getUserMedia","video","audio","initializeSpeechRecognition","SpeechRecognition","window","webkitSpeechRecognition","current","continuous","interimResults","lang","onresult","event","last","results","length","text","checkForbiddenWords","onerror","start","onend","forEach","word","includes","has","add","newCount","size","terminateExam","close","detectFace","readyState","detections","detectAllFaces","TinyFaceDetectorOptions","isFacePresent","prev","interval","setInterval","clearInterval","detectSound","audioContext","AudioContext","analyser","createAnalyser","source","createMediaStreamSource","connect","fftSize","bufferLength","frequencyBinCount","dataArray","Uint8Array","checkSound","getByteFrequencyData","volume","reduce","sum","value","requestAnimationFrame","captureAndSendImage","imageSrc","getScreenshot","img","fetchImage","detection","detectSingleFace","withFaceLandmarks","withFaceDescriptor","descriptor","distance","euclideanDistance","violationData","studentId","examId","image","timestamp","Date","toISOString","post","err","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","ref","screenshotFormat","videoConstraints","facingMode","width","height","src","alt","dir","map","imgObj","index","_c","$RefreshReg$"],"sources":["E:/continous-authentication/frontend/src/ContinuousAuth.js"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback } from \"react\";\r\nimport * as faceapi from \"face-api.js\";\r\nimport Webcam from \"react-webcam\";\r\nimport forbiddenWordsList from \"./forbiddenWords.json\";\r\nimport \"./ContinuousAuth.css\";\r\nimport axios from \"axios\";\r\n\r\nconst ContinuousAuth = () => {\r\n  const webcamRef = useRef(null);\r\n  const recognitionRef = useRef(null);\r\n\r\n  const [faceDetected, setFaceDetected] = useState(false);\r\n  const [soundDetected, setSoundDetected] = useState(false);\r\n  const [currentImage, setCurrentImage] = useState(null);\r\n  const [permissionsGranted, setPermissionsGranted] = useState(false);\r\n  const [examTerminated, setExamTerminated] = useState(false);\r\n  const [mediaStream, setMediaStream] = useState(null);\r\n  const [showPermissionMessage, setShowPermissionMessage] = useState(true);\r\n  const [noFaceDuration, setNoFaceDuration] = useState(0);\r\n  const [transcript, setTranscript] = useState(\"\");\r\n  const [violations, setViolations] = useState(0);\r\n  const forbiddenWords = forbiddenWordsList.words;\r\n  const [forbiddenCount, setForbiddenCount] = useState(0);\r\n  const detectedForbiddenWords = useRef(new Set());\r\n\r\n  // Face Comparison States\r\n  const [referenceDescriptor, setReferenceDescriptor] = useState(null);\r\n  const [violationCount, setViolationCount] = useState(0);\r\n  const [capturedImages, setCapturedImages] = useState([]);\r\n\r\n  // Custom Alert with Arabic and English\r\n  const customAlert = (messageAr, messageEn) => {\r\n    alert(`${messageAr}\\n\\n${messageEn}`);\r\n  };\r\n\r\n  // Load required models\r\n  useEffect(() => {\r\n    const loadModels = async () => {\r\n      try {\r\n        await faceapi.nets.tinyFaceDetector.loadFromUri(\"/models\");\r\n        await faceapi.nets.faceLandmark68Net.loadFromUri(\"/models\");\r\n        await faceapi.nets.faceRecognitionNet.loadFromUri(\"/models\");\r\n\r\n        console.log(\"All required models loaded successfully\");\r\n      } catch (error) {\r\n        customAlert(\r\n          \"فشل في تحميل نماذج التعرف على الوجه. يرجى التأكد من وجود ملفات النموذج في المسار الصحيح.\",\r\n          \"Failed to load face recognition models. Please check the model files are in the correct path.\"\r\n        );\r\n      }\r\n    };\r\n\r\n    loadModels();\r\n  }, []);\r\n\r\n  const getPermissions = async () => {\r\n    try {\r\n      const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });\r\n      setMediaStream(stream);\r\n      setPermissionsGranted(true);\r\n      setShowPermissionMessage(false);\r\n      initializeSpeechRecognition();\r\n    } catch (error) {\r\n      customAlert(\r\n        \"يرجى السماح بالوصول إلى الكاميرا والميكروفون.\",\r\n        \"Please allow access to camera and microphone.\"\r\n      );\r\n      setShowPermissionMessage(true);\r\n    }\r\n  };\r\n\r\n  const initializeSpeechRecognition = () => {\r\n    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;\r\n    if (!SpeechRecognition) {\r\n      console.error(\"API التعرف على الصوت غير مدعومة في هذا المتصفح\");\r\n      return;\r\n    }\r\n\r\n    recognitionRef.current = new SpeechRecognition();\r\n    recognitionRef.current.continuous = true;\r\n    recognitionRef.current.interimResults = false;\r\n    recognitionRef.current.lang = \"ar-SA\";\r\n\r\n    recognitionRef.current.onresult = (event) => {\r\n      const last = event.results.length - 1;\r\n      const text = event.results[last][0].transcript;\r\n      console.log(\"تم التعرف على النص:\", text);\r\n      setTranscript(text);\r\n      checkForbiddenWords(text);\r\n    };\r\n\r\n    recognitionRef.current.onerror = (event) => {\r\n      console.error(\"خطأ في التعرف على الكلام\", event.error);\r\n    };\r\n\r\n    recognitionRef.current.start();\r\n\r\n    recognitionRef.current.onend = () => {\r\n      recognitionRef.current.start();\r\n    };\r\n  };\r\n\r\n  const checkForbiddenWords = (text) => {\r\n    forbiddenWords.forEach((word) => {\r\n      if (text.includes(word)) {\r\n        if (!detectedForbiddenWords.current.has(word)) {\r\n          detectedForbiddenWords.current.add(word);\r\n          const newCount = detectedForbiddenWords.current.size;\r\n          setForbiddenCount(newCount);\r\n          console.log(`تم اكتشاف كلمة محظورة جديدة: ${word} (المجموع: ${newCount})`);\r\n          if (newCount >= 3) {\r\n            customAlert(\r\n              \"⚠️ تم اكتشاف 3 كلمات محظورة مختلفة! سيتم إنهاء الامتحان.\",\r\n              \"⚠️ Detected 3 different forbidden words! Exam will be terminated.\"\r\n            );\r\n            terminateExam();\r\n          }\r\n        }\r\n      }\r\n    });\r\n  };\r\n\r\n  const terminateExam = () => {\r\n    setExamTerminated(true);\r\n    customAlert(\r\n      \"✖ تم إنهاء الامتحان بسبب انتهاكات متعددة!\",\r\n      \"✖ Exam has been terminated due to multiple violations!\"\r\n    );\r\n    window.close();\r\n  };\r\n\r\n  const detectFace = async () => {\r\n    if (webcamRef.current && webcamRef.current.video.readyState === 4) {\r\n      const video = webcamRef.current.video;\r\n      const detections = await faceapi.detectAllFaces(video, new faceapi.TinyFaceDetectorOptions());\r\n      const isFacePresent = detections.length > 0;\r\n      setFaceDetected(isFacePresent);\r\n      setNoFaceDuration((prev) => (isFacePresent ? 0 : prev + 1));\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (permissionsGranted) {\r\n      const interval = setInterval(detectFace, 1000);\r\n      return () => clearInterval(interval);\r\n    }\r\n  }, [permissionsGranted]);\r\n\r\n  useEffect(() => {\r\n    if (noFaceDuration >= 30) {\r\n      customAlert(\r\n        \"⚠ لم يتم اكتشاف الوجه لمدة 30 ثانية. يرجى التأكد من ظهور وجهك بوضوح.\",\r\n        \"⚠ Face not detected for 30 seconds. Please make sure your face is clearly visible.\"\r\n      );\r\n      setNoFaceDuration(0);\r\n    }\r\n  }, [noFaceDuration]);\r\n\r\n  const detectSound = useCallback(() => {\r\n    if (!mediaStream) return;\r\n\r\n    const audioContext = new AudioContext();\r\n    const analyser = audioContext.createAnalyser();\r\n    const source = audioContext.createMediaStreamSource(mediaStream);\r\n    source.connect(analyser);\r\n    analyser.fftSize = 256;\r\n    const bufferLength = analyser.frequencyBinCount;\r\n    const dataArray = new Uint8Array(bufferLength);\r\n\r\n    const checkSound = () => {\r\n      analyser.getByteFrequencyData(dataArray);\r\n      const volume = dataArray.reduce((sum, value) => sum + value, 0) / bufferLength;\r\n      setSoundDetected(volume > 10);\r\n      requestAnimationFrame(checkSound);\r\n    };\r\n\r\n    checkSound();\r\n  }, [mediaStream]);\r\n\r\n  useEffect(() => {\r\n    if (permissionsGranted) {\r\n      detectSound();\r\n    }\r\n  }, [permissionsGranted, detectSound]);\r\n\r\n  const captureAndSendImage = async () => {\r\n    if (!webcamRef.current) return;\r\n\r\n    const imageSrc = webcamRef.current.getScreenshot();\r\n    setCurrentImage(imageSrc);\r\n\r\n    try {\r\n      const img = await faceapi.fetchImage(imageSrc);\r\n      const detection = await faceapi\r\n        .detectSingleFace(img, new faceapi.TinyFaceDetectorOptions())\r\n        .withFaceLandmarks()\r\n        .withFaceDescriptor();\r\n\r\n      if (!detection) return;\r\n\r\n      if (!referenceDescriptor) {\r\n        setReferenceDescriptor(detection.descriptor);\r\n        console.log(\"تم تخزين وجه المرجع\");\r\n        return;\r\n      }\r\n\r\n      const distance = faceapi.euclideanDistance(referenceDescriptor, detection.descriptor);\r\n      if (distance > 0.6) {\r\n        customAlert(\r\n          \"⚠️ تم اكتشاف شخص مختلف!\",\r\n          \"⚠️ Different person detected!\"\r\n        );\r\n\r\n        const violationData = {\r\n          studentId: \"student_123\",\r\n          examId: \"exam_456\",\r\n          image: imageSrc,\r\n          timestamp: new Date().toISOString(),\r\n        };\r\n\r\n        try {\r\n          await axios.post(\"http://localhost:5000/api/violation\", violationData);\r\n          setViolationCount((prev) => prev + 1);\r\n          setCapturedImages((prev) => [...prev, violationData]);\r\n\r\n          if (violationCount + 1 >= 3) {\r\n            customAlert(\r\n              \"✖ تم إنهاء الامتحان بسبب انتهاكات متعددة.\",\r\n              \"✖ Exam terminated due to multiple violations.\"\r\n            );\r\n            terminateExam();\r\n          }\r\n        } catch (err) {\r\n          console.error(\"خطأ في إرسال الانتهاك للخادم\", err);\r\n        }\r\n      }\r\n    } catch (err) {\r\n      console.error(\"خطأ في تحليل الوجه\", err);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (permissionsGranted && !examTerminated) {\r\n      const interval = setInterval(captureAndSendImage, 60000);\r\n      return () => clearInterval(interval);\r\n    }\r\n  }, [permissionsGranted, examTerminated]);\r\n\r\n  return (\r\n    <div className=\"continuous-auth-container\">\r\n      <h2>نظام الإشراف على الامتحان</h2>\r\n\r\n      {showPermissionMessage && (\r\n        <div className=\"permission-message\">\r\n          <h3>إعداد الإشراف على الامتحان</h3>\r\n          <p>يتطلب هذا الامتحان الوصول إلى الكاميرا والميكروفون لأغراض الإشراف.</p>\r\n          <div className=\"permission-requirements\">\r\n            <p>✓ يجب تمكين كشف الوجه</p>\r\n            <p>✓ يجب تفعيل الميكروفون</p>\r\n          </div>\r\n          <button className=\"permission-button\" onClick={getPermissions}>\r\n            تمكين الكاميرا والميكروفون\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {permissionsGranted && !examTerminated && (\r\n        <div className=\"monitoring-container\">\r\n          {/* Video Section */}\r\n          <div className=\"video-section\">\r\n            <Webcam\r\n              audio={true}\r\n              ref={webcamRef}\r\n              screenshotFormat=\"image/jpeg\"\r\n              className=\"webcam\"\r\n              videoConstraints={{\r\n                facingMode: \"user\",\r\n                width: 480,\r\n                height: 360,\r\n              }}\r\n            />\r\n            <div className=\"status-indicators\">\r\n              <div className={`status-indicator ${faceDetected ? \"active\" : \"\"}`}>\r\n                {faceDetected ? \"تم اكتشاف الوجه\" : \"لا يوجد وجه\"}\r\n              </div>\r\n              <div className={`status-indicator ${soundDetected ? \"active\" : \"\"}`}>\r\n                {soundDetected ? \"تم اكتشاف صوت\" : \"لا يوجد صوت\"}\r\n              </div>\r\n            </div>\r\n            {currentImage && (\r\n              <div className=\"captured-image-section\">\r\n                <h4>آخر صورة ملتقطة</h4>\r\n                <img src={currentImage} alt=\"Last captured face\" className=\"captured-image\" />\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Transcript Section */}\r\n          <div className=\"transcript-section\">\r\n            <div className=\"transcript-box\">\r\n              <div className=\"transcript-header\">\r\n                <span>نص الخطاب بالعربية</span>\r\n                <span className=\"violation-counter\">عدد الكلمات المحظورة: {forbiddenCount}/3</span>\r\n              </div>\r\n              <div className=\"transcript-content\" dir=\"rtl\">\r\n                {transcript || \"في انتظار إدخال الصوت...\"}\r\n              </div>\r\n            </div>\r\n\r\n            {capturedImages.length > 0 && (\r\n              <div className=\"all-captured-images\">\r\n                <h4>جميع الصور التي تحتوي على انتهاكات</h4>\r\n                <div className=\"captured-images-grid\">\r\n                  {capturedImages.map((imgObj, index) => (\r\n                    <img\r\n                      key={index}\r\n                      src={imgObj.image}\r\n                      alt={`Violation ${index}`}\r\n                      className=\"captured-image-small\"\r\n                    />\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {examTerminated && (\r\n        <div className=\"termination-message\">\r\n          <h3>✖ تم إنهاء الامتحان</h3>\r\n          <p>بسبب اكتشاف انتهاكات متعددة. يرجى التواصل مع المُدرِّس.</p>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ContinuousAuth;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}